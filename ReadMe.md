Моделирование движения Земли и Луны вокруг Солнца с учетом гравитационного влияния Юпитера

Цель:
Написать программу, моделирующую орбиты Земли и Луны вокруг Солнца.
Дополнительная часть: добавить в модель гравитационное воздействие Юпитера на Землю.
Предполагается использовать библиотеку matplotlib, а именно функций pyplot и FuncAnimation для создания анимации движения.
Этапы:
1.  Реализовать функцию trajectory(x0, v0, m, M, t) для расчета траектории тела m в гравитационном поле тела M. На вход функция получает начальные координаты тела, массу объекта, вокруг которого оно вращается, массу самого тела, начальную скорость и колличество шагов. Функция возвращает массивы координат.
2.  Получить массивы координат для Земли вокруг Солнца и Луны вокруг Земли
3.  Добавить в массив координат Луны координаты Земли в соответствующие моменты времени для учета перемещения Земли вокруг Солнца.
4.  Создать функцию, моделирующую траектории с помощью pyplot. Функция получает на вход массивы координат и времени.

Доп. Часть:
1. Изменить функцию моделирования траектории Земли с учетом гравитационного влияния Юпитера.
2. Реализовать анимацию движения тел по орбите.
3. Реализовать меню для выбора вида вывода графиков: с анимацией или без.


Массы тел, начальные координаты и скорости лежат в отдельном файле parameters, откуда импортируются по мере необходимости.

Описание функций:

Функция trajectory(x0, v0, m, M, t)
Тело М относительно которого вращается м ставится в 0 0, старт в т. (а, 0), а - афелий/перегелий орбиты м, v0 - по вертикали.
Возвращается массив х, у.
t - количество строк в массивах координат, в зависимости от части задачи - 28, 365, 4333
Функция использует разностную схему Эйлера с пересчетом.

Функции создания графиков:

plot() - без анимации 
plot_animation() - с анимацией, для FuncAnimation из matplotlib